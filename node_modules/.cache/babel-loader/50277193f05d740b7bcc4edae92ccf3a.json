{"ast":null,"code":"var _jsxFileName = \"D:\\\\dev\\\\Rest_Calc\\\\src\\\\DataSelection\\\\MealSelection.js\",\n  _s = $RefreshSig$();\nimport * as React from \"react\";\nimport { Table, TableBody, TableCell, TableContainer, TableHead, TableRow, Checkbox, Paper } from \"@mui/material\";\nimport { getDaysTillEndOfMonth, isAWeekDay, hasHourPassed } from \"../utils/calendar\";\nimport useLocalStorage from \"../utils/localStorage\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst rows = [\"Petit déjeuner\", \"Déjeuner\", \"Dîner\"];\nexport default function MealSelection(_ref) {\n  _s();\n  let {\n    handleChange,\n    menuSelected,\n    vacations,\n    hours\n  } = _ref;\n  const [selected, setSelected] = useLocalStorage(\"mealSelected\", {\n    \"Petit déjeuner\": [false, false, false],\n    \"Déjeuner\": [false, false, false],\n    \"Dîner\": [false, false, false]\n  });\n  const onSecondaryChange = (event, type, date) => {\n    let sel = {\n      ...selected\n    };\n    switch (date) {\n      case 'all':\n        const setAllTo = event.target.checked;\n        sel[type] = sel[type].map(x => setAllTo);\n        break;\n      case 'week':\n        sel[type][1] = event.target.checked;\n        break;\n      case 'we':\n        sel[type][2] = event.target.checked;\n        break;\n      default:\n        console.error(\"Type not found : \" + date);\n        break;\n    }\n    if (sel[type][1] === sel[type][2]) {\n      sel[type][0] = sel[type][1];\n    }\n    calculateMeals(sel, hours);\n    setSelected(sel);\n  };\n  React.useEffect(() => {\n    calculateMeals(selected, hours);\n  }, [vacations, selected, hours]);\n  const calculateMeals = (sel, hours) => {\n    let total = [0, 0];\n    let weekDays = getDaysTillEndOfMonth('week', vacations);\n    let weekEndDays = getDaysTillEndOfMonth('we', vacations);\n    if (sel[\"Petit déjeuner\"][1]) total[0] += weekDays;\n    if (sel[\"Petit déjeuner\"][2]) total[0] += weekEndDays;\n    if (sel[\"Déjeuner\"][1]) total[1] += weekDays;\n    if (sel[\"Déjeuner\"][2]) total[1] += weekEndDays;\n    if (!hasHourPassed(new Date(), hours.breakfast) && (isAWeekDay(new Date()) && sel[\"Déjeuner\"][1] || sel[\"Déjeuner\"][2])) {\n      total[1] += 1;\n    }\n    if (sel[\"Dîner\"][1]) total[1] += weekDays;\n    if (sel[\"Dîner\"][2]) total[1] += weekEndDays / 2;\n    if (!hasHourPassed(new Date(), hours.dinner) && (isAWeekDay(new Date()) && sel[\"Déjeuner\"][1] || sel[\"Déjeuner\"][2])) {\n      total[1] += 1;\n    }\n    handleChange(total);\n  };\n  return /*#__PURE__*/_jsxDEV(TableContainer, {\n    component: Paper,\n    children: /*#__PURE__*/_jsxDEV(Table, {\n      size: \"small\",\n      children: [/*#__PURE__*/_jsxDEV(TableHead, {\n        children: /*#__PURE__*/_jsxDEV(TableRow, {\n          children: [/*#__PURE__*/_jsxDEV(TableCell, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 82,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n            children: \"Semaine enti\\xE8re (7J)\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 83,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n            children: \"Semaine de cours (5J)\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 84,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n            children: \"Week-End (2J)\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 85,\n            columnNumber: 21\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(TableBody, {\n        children: rows.map(x => /*#__PURE__*/_jsxDEV(TableRow, {\n          children: [/*#__PURE__*/_jsxDEV(TableCell, {\n            children: x\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 91,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n            children: /*#__PURE__*/_jsxDEV(Checkbox, {\n              checked: selected[x][0],\n              onChange: e => onSecondaryChange(e, x, 'all')\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 92,\n              columnNumber: 36\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 92,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n            children: /*#__PURE__*/_jsxDEV(Checkbox, {\n              checked: selected[x][1],\n              onChange: e => onSecondaryChange(e, x, 'week')\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 93,\n              columnNumber: 36\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 93,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n            children: /*#__PURE__*/_jsxDEV(Checkbox, {\n              checked: selected[x][2] && menuSelected !== '5',\n              disabled: menuSelected === '5',\n              onChange: e => onSecondaryChange(e, x, 'we')\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 94,\n              columnNumber: 36\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 94,\n            columnNumber: 25\n          }, this)]\n        }, x, true, {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 21\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 78,\n    columnNumber: 13\n  }, this);\n}\n_s(MealSelection, \"aHnw48wOvdZqL2tsac4WRi01UeA=\", false, function () {\n  return [useLocalStorage];\n});\n_c = MealSelection;\nvar _c;\n$RefreshReg$(_c, \"MealSelection\");","map":{"version":3,"names":["React","Table","TableBody","TableCell","TableContainer","TableHead","TableRow","Checkbox","Paper","getDaysTillEndOfMonth","isAWeekDay","hasHourPassed","useLocalStorage","rows","MealSelection","handleChange","menuSelected","vacations","hours","selected","setSelected","onSecondaryChange","event","type","date","sel","setAllTo","target","checked","map","x","console","error","calculateMeals","useEffect","total","weekDays","weekEndDays","Date","breakfast","dinner","e"],"sources":["D:/dev/Rest_Calc/src/DataSelection/MealSelection.js"],"sourcesContent":["import * as React from \"react\"\r\nimport { Table, TableBody, TableCell, TableContainer, TableHead, TableRow, Checkbox, Paper } from \"@mui/material\"\r\nimport { getDaysTillEndOfMonth, isAWeekDay, hasHourPassed } from \"../utils/calendar\"\r\nimport useLocalStorage from \"../utils/localStorage\"\r\n\r\nconst rows = [\r\n    \"Petit déjeuner\",\r\n    \"Déjeuner\",\r\n    \"Dîner\"\r\n]\r\n\r\nexport default function MealSelection({ handleChange, menuSelected, vacations, hours }) {\r\n    const [selected, setSelected] = useLocalStorage(\"mealSelected\", {\r\n        \"Petit déjeuner\": [false, false, false],\r\n        \"Déjeuner\": [false, false, false],\r\n        \"Dîner\": [false, false, false]\r\n    })\r\n\r\n    const onSecondaryChange = (event, type, date) => {\r\n        let sel = { ...selected }\r\n        switch (date) {\r\n            case 'all':\r\n                const setAllTo = event.target.checked\r\n                sel[type] = sel[type].map(x => setAllTo)\r\n                break;\r\n            case 'week':\r\n                sel[type][1] = event.target.checked\r\n                break;\r\n            case 'we':\r\n                sel[type][2] = event.target.checked\r\n                break;\r\n            default:\r\n                console.error(\"Type not found : \" + date)\r\n                break;\r\n        }\r\n        if (sel[type][1] === sel[type][2]) {\r\n            sel[type][0] = sel[type][1]\r\n        }\r\n\r\n        calculateMeals(sel, hours)\r\n        setSelected(sel)\r\n    }\r\n\r\n    React.useEffect(() => {\r\n        calculateMeals(selected, hours)\r\n    }, [vacations, selected, hours])\r\n\r\n    const calculateMeals = (sel, hours) => {\r\n        let total = [0, 0]\r\n        let weekDays = getDaysTillEndOfMonth('week', vacations)\r\n        let weekEndDays = getDaysTillEndOfMonth('we', vacations)\r\n\r\n        if (sel[\"Petit déjeuner\"][1]) total[0] += weekDays\r\n        if (sel[\"Petit déjeuner\"][2]) total[0] += weekEndDays\r\n\r\n        if (sel[\"Déjeuner\"][1]) total[1] += weekDays\r\n        if (sel[\"Déjeuner\"][2]) total[1] += weekEndDays\r\n        if (!hasHourPassed(new Date(), hours.breakfast) \r\n            && ((isAWeekDay(new Date()) && sel[\"Déjeuner\"][1]) \r\n                || sel[\"Déjeuner\"][2]\r\n               )) {\r\n            total[1] += 1\r\n        }\r\n\r\n        if (sel[\"Dîner\"][1]) total[1] += weekDays\r\n        if (sel[\"Dîner\"][2]) total[1] += weekEndDays / 2\r\n\r\n        if (!hasHourPassed(new Date(), hours.dinner) \r\n            && ((isAWeekDay(new Date()) && sel[\"Déjeuner\"][1]) \r\n            || sel[\"Déjeuner\"][2]\r\n            )) {\r\n            total[1] += 1\r\n        }\r\n\r\n        handleChange(total)\r\n    }\r\n\r\n    return (<TableContainer component={Paper}>\r\n        <Table size=\"small\">\r\n            <TableHead>\r\n                <TableRow>\r\n                    <TableCell></TableCell>\r\n                    <TableCell>Semaine entière (7J)</TableCell>\r\n                    <TableCell>Semaine de cours (5J)</TableCell>\r\n                    <TableCell>Week-End (2J)</TableCell>\r\n                </TableRow>\r\n            </TableHead>\r\n            <TableBody>\r\n                {rows.map(x => (\r\n                    <TableRow key={x}>\r\n                        <TableCell>{x}</TableCell>\r\n                        <TableCell><Checkbox checked={selected[x][0]} onChange={e => onSecondaryChange(e, x, 'all')} /></TableCell>\r\n                        <TableCell><Checkbox checked={selected[x][1]} onChange={e => onSecondaryChange(e, x, 'week')} /></TableCell>\r\n                        <TableCell><Checkbox checked={selected[x][2] && menuSelected !== '5'} disabled={menuSelected === '5'} onChange={e => onSecondaryChange(e, x, 'we')} /></TableCell>\r\n                    </TableRow>\r\n                ))}\r\n            </TableBody>\r\n        </Table>\r\n    </TableContainer>)\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}