{"ast":null,"code":"import _objectSpread from\"D:/dev/Rest_Calc/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"D:/dev/Rest_Calc/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import*as React from\"react\";import{Table,TableBody,TableCell,TableContainer,TableHead,TableRow,Checkbox,Paper}from\"@mui/material\";import{getDaysTillEndOfMonth,isAWeekDay,hasHourPassed}from\"../utils/calendar\";import useLocalStorage from\"../utils/localStorage\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var rows=[\"Petit déjeuner\",\"Déjeuner\",\"Dîner\"];export default function MealSelection(_ref){var handleChange=_ref.handleChange,menuSelected=_ref.menuSelected,vacations=_ref.vacations,hours=_ref.hours;var _useLocalStorage=useLocalStorage(\"mealSelected\",{\"Petit déjeuner\":[false,false,false],\"Déjeuner\":[false,false,false],\"Dîner\":[false,false,false]}),_useLocalStorage2=_slicedToArray(_useLocalStorage,2),selected=_useLocalStorage2[0],setSelected=_useLocalStorage2[1];var onSecondaryChange=function onSecondaryChange(event,type,date){var sel=_objectSpread({},selected);switch(date){case'all':var setAllTo=event.target.checked;sel[type]=sel[type].map(function(x){return setAllTo;});break;case'week':sel[type][1]=event.target.checked;break;case'we':sel[type][2]=event.target.checked;break;default:console.error(\"Type not found : \"+date);break;}if(sel[type][1]===sel[type][2]){sel[type][0]=sel[type][1];}calculateMeals(sel,hours);setSelected(sel);};React.useEffect(function(){calculateMeals(selected,hours);},[vacations,selected,hours]);var calculateMeals=function calculateMeals(sel,hours){var total=[0,0];var weekDays=getDaysTillEndOfMonth('week',vacations);var weekEndDays=getDaysTillEndOfMonth('we',vacations);if(sel[\"Petit déjeuner\"][1])total[0]+=weekDays;if(sel[\"Petit déjeuner\"][2])total[0]+=weekEndDays;if(sel[\"Déjeuner\"][1])total[1]+=weekDays;if(sel[\"Déjeuner\"][2])total[1]+=weekEndDays;if(hours&&!hours.disabled&&!hasHourPassed(new Date(),hours.breakfast)&&(isAWeekDay(new Date())&&sel[\"Déjeuner\"][1]||!isAWeekDay(new Date())&&sel[\"Déjeuner\"][2])){total[1]+=1;}if(sel[\"Dîner\"][1])total[1]+=weekDays;if(sel[\"Dîner\"][2])total[1]+=weekEndDays/2;if(hours&&!hours.disabled&&!hasHourPassed(new Date(),hours.diner)&&(isAWeekDay(new Date())&&sel[\"Dîner\"][1]||!isAWeekDay(new Date())&&sel[\"Dîner\"][2])){total[1]+=1;}handleChange(total);};return/*#__PURE__*/_jsx(TableContainer,{component:Paper,children:/*#__PURE__*/_jsxs(Table,{size:\"small\",children:[/*#__PURE__*/_jsx(TableHead,{children:/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{}),/*#__PURE__*/_jsx(TableCell,{children:\"Semaine enti\\xE8re (7J)\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Semaine de cours (5J)\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Week-End (2J)\"})]})}),/*#__PURE__*/_jsx(TableBody,{children:rows.map(function(x){return/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{children:x}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(Checkbox,{checked:selected[x][0],onChange:function onChange(e){return onSecondaryChange(e,x,'all');}})}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(Checkbox,{checked:selected[x][1],onChange:function onChange(e){return onSecondaryChange(e,x,'week');}})}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(Checkbox,{checked:selected[x][2]&&menuSelected!=='5',disabled:menuSelected==='5',onChange:function onChange(e){return onSecondaryChange(e,x,'we');}})})]},x);})})]})});}","map":{"version":3,"names":["React","Table","TableBody","TableCell","TableContainer","TableHead","TableRow","Checkbox","Paper","getDaysTillEndOfMonth","isAWeekDay","hasHourPassed","useLocalStorage","rows","MealSelection","handleChange","menuSelected","vacations","hours","selected","setSelected","onSecondaryChange","event","type","date","sel","setAllTo","target","checked","map","x","console","error","calculateMeals","useEffect","total","weekDays","weekEndDays","disabled","Date","breakfast","diner","e"],"sources":["D:/dev/Rest_Calc/src/DataSelection/MealSelection.js"],"sourcesContent":["import * as React from \"react\"\r\nimport { Table, TableBody, TableCell, TableContainer, TableHead, TableRow, Checkbox, Paper } from \"@mui/material\"\r\nimport { getDaysTillEndOfMonth, isAWeekDay, hasHourPassed } from \"../utils/calendar\"\r\nimport useLocalStorage from \"../utils/localStorage\"\r\n\r\nconst rows = [\r\n    \"Petit déjeuner\",\r\n    \"Déjeuner\",\r\n    \"Dîner\"\r\n]\r\n\r\nexport default function MealSelection({ handleChange, menuSelected, vacations, hours }) {\r\n    const [selected, setSelected] = useLocalStorage(\"mealSelected\", {\r\n        \"Petit déjeuner\": [false, false, false],\r\n        \"Déjeuner\": [false, false, false],\r\n        \"Dîner\": [false, false, false]\r\n    })\r\n\r\n    const onSecondaryChange = (event, type, date) => {\r\n        let sel = { ...selected }\r\n        switch (date) {\r\n            case 'all':\r\n                const setAllTo = event.target.checked\r\n                sel[type] = sel[type].map(x => setAllTo)\r\n                break;\r\n            case 'week':\r\n                sel[type][1] = event.target.checked\r\n                break;\r\n            case 'we':\r\n                sel[type][2] = event.target.checked\r\n                break;\r\n            default:\r\n                console.error(\"Type not found : \" + date)\r\n                break;\r\n        }\r\n        if (sel[type][1] === sel[type][2]) {\r\n            sel[type][0] = sel[type][1]\r\n        }\r\n\r\n        calculateMeals(sel, hours)\r\n        setSelected(sel)\r\n    }\r\n\r\n    React.useEffect(() => {\r\n        calculateMeals(selected, hours)\r\n    }, [vacations, selected, hours])\r\n\r\n    const calculateMeals = (sel, hours) => {\r\n        let total = [0, 0]\r\n        let weekDays = getDaysTillEndOfMonth('week', vacations)\r\n        let weekEndDays = getDaysTillEndOfMonth('we', vacations)\r\n\r\n        if (sel[\"Petit déjeuner\"][1]) total[0] += weekDays\r\n        if (sel[\"Petit déjeuner\"][2]) total[0] += weekEndDays\r\n\r\n        if (sel[\"Déjeuner\"][1]) total[1] += weekDays\r\n        if (sel[\"Déjeuner\"][2]) total[1] += weekEndDays\r\n        if (hours && !hours.disabled && !hasHourPassed(new Date(), hours.breakfast) \r\n            && ((isAWeekDay(new Date()) && sel[\"Déjeuner\"][1]) \r\n                || (!isAWeekDay(new Date()) && sel[\"Déjeuner\"][2])\r\n               )) {\r\n            total[1] += 1\r\n        }\r\n\r\n        if (sel[\"Dîner\"][1]) total[1] += weekDays\r\n        if (sel[\"Dîner\"][2]) total[1] += weekEndDays / 2\r\n\r\n        if (hours && !hours.disabled && !hasHourPassed(new Date(), hours.diner) \r\n            && ((isAWeekDay(new Date()) && sel[\"Dîner\"][1]) \r\n            || (!isAWeekDay(new Date()) && sel[\"Dîner\"][2])\r\n            )) {\r\n            total[1] += 1\r\n        }\r\n        handleChange(total)\r\n    }\r\n\r\n    return (<TableContainer component={Paper}>\r\n        <Table size=\"small\">\r\n            <TableHead>\r\n                <TableRow>\r\n                    <TableCell></TableCell>\r\n                    <TableCell>Semaine entière (7J)</TableCell>\r\n                    <TableCell>Semaine de cours (5J)</TableCell>\r\n                    <TableCell>Week-End (2J)</TableCell>\r\n                </TableRow>\r\n            </TableHead>\r\n            <TableBody>\r\n                {rows.map(x => (\r\n                    <TableRow key={x}>\r\n                        <TableCell>{x}</TableCell>\r\n                        <TableCell><Checkbox checked={selected[x][0]} onChange={e => onSecondaryChange(e, x, 'all')} /></TableCell>\r\n                        <TableCell><Checkbox checked={selected[x][1]} onChange={e => onSecondaryChange(e, x, 'week')} /></TableCell>\r\n                        <TableCell><Checkbox checked={selected[x][2] && menuSelected !== '5'} disabled={menuSelected === '5'} onChange={e => onSecondaryChange(e, x, 'we')} /></TableCell>\r\n                    </TableRow>\r\n                ))}\r\n            </TableBody>\r\n        </Table>\r\n    </TableContainer>)\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}